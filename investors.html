<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SyndicatePro - Investors</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #0f172a;
      --primary-light: #1e293b;
      --secondary: #334155;
      --accent: #3b82f6;
      --accent-hover: #2563eb;
      --accent-light: #dbeafe;
      --success: #10b981;
      --success-light: #d1fae5;
      --warning: #f59e0b;
      --warning-light: #fef3c7;
      --danger: #ef4444;
      --danger-light: #fee2e2;
      --text: #0f172a;
      --text-secondary: #64748b;
      --text-muted: #94a3b8;
      --border: #e2e8f0;
      --border-light: #f1f5f9;
      --bg: #f8fafc;
      --bg-card: #ffffff;
      --bg-sidebar: #0f172a;
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
      --radius-sm: 6px;
      --radius: 8px;
      --radius-md: 12px;
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
    }
    
    .app { display: flex; min-height: 100vh; }
    
    .sidebar {
      width: 260px;
      background: var(--bg-sidebar);
      color: white;
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      z-index: 100;
    }
    
    .sidebar-header {
      padding: 24px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 1.25rem;
      font-weight: 700;
    }
    
    .logo-icon {
      width: 36px;
      height: 36px;
      background: linear-gradient(135deg, var(--accent), #60a5fa);
      border-radius: var(--radius);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
    }
    
    .nav {
      flex: 1;
      padding: 16px 12px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    
    .nav-section {
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: rgba(255,255,255,0.4);
      padding: 16px 12px 8px;
    }
    
    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 12px;
      border-radius: var(--radius);
      color: rgba(255,255,255,0.7);
      text-decoration: none;
      font-size: 0.9rem;
      font-weight: 500;
      transition: all 0.15s;
    }
    
    .nav-item:hover { background: rgba(255,255,255,0.05); color: white; }
    .nav-item.active { background: var(--accent); color: white; }
    .nav-item i { width: 20px; text-align: center; }
    
    .sidebar-footer {
      padding: 16px;
      border-top: 1px solid rgba(255,255,255,0.1);
    }
    
    .user-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .user-avatar {
      width: 36px;
      height: 36px;
      background: linear-gradient(135deg, var(--success), #34d399);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.9rem;
    }
    
    .user-details { flex: 1; }
    .user-name { font-size: 0.9rem; font-weight: 600; }
    .user-role { font-size: 0.75rem; color: rgba(255,255,255,0.5); }
    
    .main { flex: 1; margin-left: 260px; min-height: 100vh; }
    
    .top-bar {
      background: var(--bg-card);
      border-bottom: 1px solid var(--border);
      padding: 16px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 50;
    }
    
    .breadcrumb {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.875rem;
      color: var(--text-secondary);
    }
    
    .breadcrumb a { color: var(--text-secondary); text-decoration: none; }
    .breadcrumb a:hover { color: var(--accent); }
    .breadcrumb-separator { color: var(--text-muted); }
    .breadcrumb-current { color: var(--text); font-weight: 500; }
    
    .top-actions { display: flex; gap: 12px; align-items: center; }
    
    .btn-icon {
      width: 40px;
      height: 40px;
      border: 1px solid var(--border);
      background: var(--bg-card);
      border-radius: var(--radius);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.15s;
    }
    
    .btn-icon:hover { border-color: var(--accent); color: var(--accent); }
    
    .content { padding: 32px; max-width: 1600px; }
    
    .page-header { margin-bottom: 32px; }
    .page-title { font-size: 1.875rem; font-weight: 700; color: var(--text); margin-bottom: 8px; }
    .page-description { color: var(--text-secondary); font-size: 1rem; }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-bottom: 32px;
    }
    
    @media (max-width: 1024px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 640px) { .stats-grid { grid-template-columns: 1fr; } }
    
    .stat-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: 24px;
      transition: box-shadow 0.15s;
    }
    
    .stat-card:hover { box-shadow: var(--shadow-md); }
    
    .stat-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 16px;
    }
    
    .stat-icon {
      width: 44px;
      height: 44px;
      border-radius: var(--radius);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
    }
    
    .stat-icon.blue { background: var(--accent-light); color: var(--accent); }
    .stat-icon.green { background: var(--success-light); color: var(--success); }
    .stat-icon.amber { background: var(--warning-light); color: var(--warning); }
    
    .stat-value {
      font-size: 1.75rem;
      font-weight: 700;
      font-family: 'JetBrains Mono', monospace;
      color: var(--text);
      margin-bottom: 4px;
    }
    
    .stat-label { font-size: 0.875rem; color: var(--text-secondary); }
    
    .card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      overflow: hidden;
    }
    
    .card-header {
      padding: 20px 24px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .card-title { font-size: 1rem; font-weight: 600; color: var(--text); }
    .card-subtitle { font-size: 0.875rem; color: var(--text-secondary); margin-top: 4px; }
    .card-body { padding: 0; }
    
    .content-grid { display: grid; grid-template-columns: 1fr 400px; gap: 24px; }
    @media (max-width: 1200px) { .content-grid { grid-template-columns: 1fr; } }
    
    .search-box {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      background: var(--border-light);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      width: 300px;
    }
    
    .search-box i { color: var(--text-muted); }
    .search-box input {
      border: none;
      background: transparent;
      outline: none;
      font-size: 0.9rem;
      width: 100%;
    }
    
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 10px 18px;
      font-size: 0.9rem;
      font-weight: 600;
      border-radius: var(--radius);
      border: none;
      cursor: pointer;
      transition: all 0.15s;
      text-decoration: none;
    }
    
    .btn-primary { background: var(--accent); color: white; }
    .btn-primary:hover { background: var(--accent-hover); box-shadow: var(--shadow-md); }
    .btn-secondary { background: var(--bg-card); color: var(--text); border: 1px solid var(--border); }
    .btn-secondary:hover { background: var(--border-light); border-color: var(--text-muted); }
    .btn-ghost { background: transparent; color: var(--text-secondary); }
    .btn-ghost:hover { background: var(--border-light); color: var(--text); }
    .btn-sm { padding: 6px 12px; font-size: 0.8rem; }
    
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 14px 20px; text-align: left; border-bottom: 1px solid var(--border); }
    th {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--text-secondary);
      background: var(--border-light);
    }
    td { font-size: 0.9rem; }
    tr:hover { background: var(--border-light); }
    
    .investor-name { font-weight: 600; }
    .investor-email { font-size: 0.8rem; color: var(--text-secondary); }
    
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
    }
    
    .badge-green { background: var(--success-light); color: var(--success); }
    .badge-amber { background: var(--warning-light); color: var(--warning); }
    .badge-blue { background: var(--accent-light); color: var(--accent); }
    .badge-dot { width: 6px; height: 6px; border-radius: 50%; }
    
    .font-mono { font-family: 'JetBrains Mono', monospace; font-weight: 600; }
    .text-success { color: var(--success); }
    .text-accent { color: var(--accent); }
    .text-muted { color: var(--text-muted); }
    
    .empty-state {
      text-align: center;
      padding: 60px 40px;
      color: var(--text-secondary);
    }
    .empty-state .icon {
      width: 80px;
      height: 80px;
      background: var(--border-light);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
      font-size: 2rem;
      color: var(--text-muted);
    }
    
    .detail-row {
      display: flex;
      justify-content: space-between;
      padding: 14px 0;
      border-bottom: 1px solid var(--border);
    }
    .detail-row:last-child { border-bottom: none; }
    .detail-label { font-size: 0.875rem; color: var(--text-secondary); }
    .detail-value { font-weight: 600; }
    
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    .modal-overlay.active { display: flex; }
    
    .modal {
      background: var(--bg-card);
      border-radius: var(--radius-md);
      width: 90%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: var(--shadow-lg);
    }
    
    .modal-header {
      padding: 20px 24px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .modal-title { font-size: 1.25rem; font-weight: 700; }
    .close-btn {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--text-muted);
      cursor: pointer;
    }
    
    .modal-body { padding: 24px; }
    .modal-footer {
      padding: 16px 24px;
      border-top: 1px solid var(--border);
      background: var(--border-light);
      display: flex;
      justify-content: flex-end;
      gap: 12px;
    }
    
    .form-group { margin-bottom: 20px; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    
    label { display: block; font-size: 0.875rem; font-weight: 500; color: var(--text); margin-bottom: 8px; }
    
    input, select {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      font-size: 0.95rem;
      font-family: inherit;
      background: var(--bg-card);
      color: var(--text);
      transition: all 0.15s;
    }
    
    input:focus, select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-light);
    }
    
    .checkbox-group {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      margin-top: 8px;
    }
    .checkbox-item {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .checkbox-item input[type="checkbox"] { width: auto; }
    
    @media (max-width: 768px) {
      .sidebar { transform: translateX(-100%); }
      .main { margin-left: 0; }
      .form-row { grid-template-columns: 1fr; }
      .search-box { width: 100%; }
    }
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <div class="logo-icon">â—†</div>
          <span>SyndicatePro</span>
        </div>
      </div>
      <nav class="nav">
        <div class="nav-section">Main</div>
        <a href="index.html" class="nav-item"><i class="fas fa-calculator"></i><span>Deal Modeling</span></a>
        <a href="documents.html" class="nav-item"><i class="fas fa-file-contract"></i><span>Documents</span></a>
        <a href="investors.html" class="nav-item active"><i class="fas fa-users"></i><span>Investors</span></a>
        <a href="reports.html" class="nav-item"><i class="fas fa-chart-bar"></i><span>Reports</span></a>
        <div class="nav-section">Tools</div>
        <a href="distributions.html" class="nav-item"><i class="fas fa-wallet"></i><span>Distributions</span></a>
        <a href="k1-generator.html" class="nav-item"><i class="fas fa-file-invoice-dollar"></i><span>K-1 Generator</span></a>
        <a href="email-templates.html" class="nav-item"><i class="fas fa-envelope"></i><span>Email Templates</span></a>
        <a href="pipeline.html" class="nav-item"><i class="fas fa-layer-group"></i><span>Pipeline</span></a>
      </nav>
      <div class="sidebar-footer">
        <div class="user-info">
          <div class="user-avatar">GP</div>
          <div class="user-details">
            <div class="user-name">General Partner</div>
            <div class="user-role">Administrator</div>
          </div>
        </div>
      </div>
    </aside>
    
    <main class="main">
      <header class="top-bar">
        <div class="breadcrumb">
          <a href="index.html">Home</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-current">Investors</span>
        </div>
        <div class="top-actions">
          <button class="btn-icon" title="Help"><i class="fas fa-question-circle"></i></button>
          <button class="btn-icon" title="Notifications"><i class="fas fa-bell"></i></button>
        </div>
      </header>
      
      <div class="content">
        <div class="page-header">
          <h1 class="page-title">Investor Management</h1>
          <p class="page-description">Manage your LP relationships and track investments</p>
        </div>
        
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-header">
              <div class="stat-icon blue"><i class="fas fa-users"></i></div>
            </div>
            <div class="stat-value" id="totalInvestors">0</div>
            <div class="stat-label">Total Investors</div>
          </div>
          <div class="stat-card">
            <div class="stat-header">
              <div class="stat-icon green"><i class="fas fa-check-circle"></i></div>
            </div>
            <div class="stat-value" id="accreditedCount">0</div>
            <div class="stat-label">Accredited</div>
          </div>
          <div class="stat-card">
            <div class="stat-header">
              <div class="stat-icon amber"><i class="fas fa-dollar-sign"></i></div>
            </div>
            <div class="stat-value" id="totalAUM">$0</div>
            <div class="stat-label">Total AUM</div>
          </div>
          <div class="stat-card">
            <div class="stat-header">
              <div class="stat-icon blue" style="background: #e0e7ff; color: #6366f1;"><i class="fas fa-building"></i></div>
            </div>
            <div class="stat-value" id="activeDeals">0</div>
            <div class="stat-label">Active Deals</div>
          </div>
        </div>
        
        <div class="content-grid">
          <div class="left-panel">
            <div class="card">
              <div class="card-header">
                <div>
                  <h2 class="card-title">Investor List</h2>
                  <p class="card-subtitle">Manage your limited partners</p>
                </div>
                <div style="display: flex; gap: 12px;">
                  <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="Search investors...">
                  </div>
                  <button class="btn btn-primary" onclick="openModal()">
                    <i class="fas fa-plus"></i> Add
                  </button>
                </div>
              </div>
              <div class="card-body">
                <table>
                  <thead>
                    <tr>
                      <th>Investor</th>
                      <th>Status</th>
                      <th>Total Invested</th>
                      <th>Deals</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody id="investorTableBody">
                    <tr>
                      <td colspan="5" class="empty-state">
                        <div class="icon"><i class="fas fa-users"></i></div>
                        <p>No investors yet. Add your first investor to get started.</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          
          <div class="right-panel">
            <div class="card" id="detailCard" style="display: none;">
              <div class="card-header">
                <div>
                  <h2 class="card-title" id="detailName">Investor Details</h2>
                  <p class="card-subtitle">View and manage investor information</p>
                </div>
                <button class="btn btn-sm btn-secondary" onclick="editCurrent()">
                  <i class="fas fa-edit"></i> Edit
                </button>
              </div>
              <div class="card-body" id="detailContent" style="padding: 20px 24px;">
              </div>
              <div style="padding: 16px 24px; border-top: 1px solid var(--border); background: var(--border-light); display: flex; gap: 12px;">
                <button class="btn btn-primary btn-sm" onclick="addInvestment()">
                  <i class="fas fa-plus"></i> Add Investment
                </button>
                <button class="btn btn-secondary btn-sm" onclick="sendDocument()">
                  <i class="fas fa-envelope"></i> Send Doc
                </button>
                <button class="btn btn-ghost btn-sm" style="margin-left: auto; color: var(--danger);" onclick="deleteInvestor()">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </div>
            
            <div class="card" id="emptyDetail" style="text-align: center; padding: 60px 40px;">
              <div style="width: 80px; height: 80px; background: var(--border-light); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 2rem; color: var(--text-muted);"><i class="fas fa-user"></i></div>
              <h3 style="margin-bottom: 8px;">Select an investor</h3>
              <p style="color: var(--text-secondary);">Click on an investor to view their details</p>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
  
  <div class="modal-overlay" id="modal">
    <div class="modal">
      <div class="modal-header">
        <h2 class="modal-title" id="modalTitle">Add New Investor</h2>
        <button class="close-btn" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="investorForm">
          <input type="hidden" id="investorId">
          <div class="form-row">
            <div class="form-group">
              <label>First Name</label>
              <input type="text" id="firstName" required>
            </div>
            <div class="form-group">
              <label>Last Name</label>
              <input type="text" id="lastName" required>
            </div>
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="email" required>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Phone</label>
              <input type="tel" id="phone">
            </div>
            <div class="form-group">
              <label>Entity Name</label>
              <input type="text" id="entityName" placeholder="e.g., Smith Family Holdings LLC">
            </div>
          </div>
          <div class="form-group">
            <label>Address</label>
            <input type="text" id="address">
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Accredited Status</label>
              <select id="accreditedStatus">
                <option value="verified">Verified Accredited</option>
                <option value="self">Self-Certified</option>
                <option value="pending">Pending Verification</option>
                <option value="non-accredited">Non-Accredited</option>
              </select>
            </div>
            <div class="form-group">
              <label>Verification Method</label>
              <select id="verificationMethod">
                <option value="">Select method...</option>
                <option value="cpa-letter">CPA Letter</option>
                <option value="tax-returns">Tax Returns</option>
                <option value="net-worth">Net Worth Statement</option>
                <option value="series7">Series 7/65/82 License</option>
                <option value="knowledgeable">Knowledgeable Employee</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label>Investment Preferences</label>
            <div class="checkbox-group">
              <label class="checkbox-item"><input type="checkbox" id="prefMultifamily"> Multifamily</label>
              <label class="checkbox-item"><input type="checkbox" id="prefRetail"> Retail</label>
              <label class="checkbox-item"><input type="checkbox" id="prefIndustrial"> Industrial</label>
              <label class="checkbox-item"><input type="checkbox" id="prefOffice"> Office</label>
            </div>
          </div>
          <div class="form-group">
            <label>Notes</label>
            <input type="text" id="notes" placeholder="Additional notes...">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
        <button class="btn btn-primary" onclick="saveInvestor()">Save Investor</button>
      </div>
    </div>
  </div>

  <script src="js/storage.js"></script>
  <script>
    // Auth guard
    const auth = JSON.parse(localStorage.getItem('auth') || '{}');
    if (!auth.isAuthenticated) {
      window.location.href = 'login.html';
    }
  </script>
  <script>
    let currentInvestor = null;
    let investors = [];
    
    function formatCurrency(num) {
      return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(num || 0);
    }
    
    function loadInvestors() {
      investors = Storage.getInvestors();
      renderTable();
      updateStats();
    }
    
    function renderTable() {
      const tbody = document.getElementById('investorTableBody');
      const searchTerm = (document.getElementById('searchInput').value || '').toLowerCase();
      
      const filtered = investors.filter(inv => {
        const name = `${inv.firstName} ${inv.lastName}`.toLowerCase();
        const email = (inv.email || '').toLowerCase();
        const entity = (inv.entityName || '').toLowerCase();
        return name.includes(searchTerm) || email.includes(searchTerm) || entity.includes(searchTerm);
      });
      
      if (filtered.length === 0) {
        tbody.innerHTML = `<tr><td colspan="5" class="empty-state"><div class="icon"><i class="fas fa-users"></i></div><p>${investors.length === 0 ? 'No investors yet. Add your first investor to get started.' : 'No matching investors found.'}</p></td></tr>`;
        return;
      }
      
      tbody.innerHTML = filtered.map(inv => {
        const badgeClass = inv.accreditedStatus === 'verified' ? 'badge-green' : 'badge-amber';
        const badgeText = inv.accreditedStatus === 'verified' ? 'Accredited' : inv.accreditedStatus === 'non-accredited' ? 'Non-Accredited' : 'Pending';
        const totalInvested = (inv.investments || []).reduce((sum, i) => sum + (i.amount || 0), 0);
        
        return `<tr style="cursor: pointer;" onclick="showInvestor('${inv.id}')"><td><div class="investor-name">${inv.firstName} ${inv.lastName}</div><div class="investor-email">${inv.email}</div></td><td><span class="badge ${badgeClass}"><span class="badge-dot" style="background: currentColor;"></span>${badgeText}</span></td><td class="font-mono text-success">${formatCurrency(totalInvested)}</td><td>${(inv.dealIds || []).length}</td><td><button class="btn btn-sm btn-ghost" onclick="event.stopPropagation(); editInvestor('${inv.id}')"><i class="fas fa-edit"></i></button></td></tr>`;
      }).join('');
    }
    
    function updateStats() {
      document.getElementById('totalInvestors').textContent = investors.length;
      document.getElementById('accreditedCount').textContent = investors.filter(i => i.accreditedStatus === 'verified').length;
      const totalAUM = investors.reduce((sum, inv) => sum + (inv.investments || []).reduce((s, i) => s + (i.amount || 0), 0), 0);
      document.getElementById('totalAUM').textContent = formatCurrency(totalAUM);
      document.getElementById('activeDeals').textContent = Storage.getDeals().filter(d => d.status === 'active').length;
    }
    
    function showInvestor(id) {
      currentInvestor = investors.find(i => i.id === id);
      if (!currentInvestor) return;
      
      document.getElementById('emptyDetail').style.display = 'none';
      document.getElementById('detailCard').style.display = 'block';
      
      const name = currentInvestor.entityName || `${currentInvestor.firstName} ${currentInvestor.lastName}`;
      document.getElementById('detailName').textContent = name;
      
      const totalInvested = (currentInvestor.investments || []).reduce((sum, i) => sum + (i.amount || 0), 0);
      
      document.getElementById('detailContent').innerHTML = `
        <div class="detail-row"><span class="detail-label">Email</span><span class="detail-value">${currentInvestor.email}</span></div>
        <div class="detail-row"><span class="detail-label">Phone</span><span class="detail-value">${currentInvestor.phone || 'Not provided'}</span></div>
        <div class="detail-row"><span class="detail-label">Address</span><span class="detail-value">${currentInvestor.address || 'Not provided'}</span></div>
        <div class="detail-row"><span class="detail-label">Total Invested</span><span class="detail-value font-mono text-success">${formatCurrency(totalInvested)}</span></div>
        <div class="detail-row"><span class="detail-label">Accreditation</span><span class="detail-value" style="text-transform: capitalize;">${(currentInvestor.accreditedStatus || 'pending').replace('-', ' ')}</span></div>
        ${currentInvestor.verificationMethod ? `<div class="detail-row"><span class="detail-label">Verified Via</span><span class="detail-value" style="text-transform: capitalize;">${currentInvestor.verificationMethod.replace('-', ' ')}</span></div>` : ''}
        ${currentInvestor.notes ? `<div class="detail-row"><span class="detail-label">Notes</span><span class="detail-value">${currentInvestor.notes}</span></div>` : ''}
      `;
    }
    
    function openModal() {
      document.getElementById('modal').classList.add('active');
      document.getElementById('modalTitle').textContent = 'Add New Investor';
      document.getElementById('investorForm').reset();
      document.getElementById('investorId').value = '';
    }
    
    function closeModal() { document.getElementById('modal').classList.remove('active'); }
    
    function saveInvestor() {
      const preferences = [];
      if (document.getElementById('prefMultifamily').checked) preferences.push('Multifamily');
      if (document.getElementById('prefRetail').checked) preferences.push('Retail');
      if (document.getElementById('prefIndustrial').checked) preferences.push('Industrial');
      if (document.getElementById('prefOffice').checked) preferences.push('Office');
      
      const investor = {
        id: document.getElementById('investorId').value || Date.now().toString(),
        firstName: document.getElementById('firstName').value,
        lastName: document.getElementById('lastName').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        entityName: document.getElementById('entityName').value,
        address: document.getElementById('address').value,
        accreditedStatus: document.getElementById('accreditedStatus').value,
        verificationMethod: document.getElementById('verificationMethod').value,
        preferences: preferences,
        notes: document.getElementById('notes').value,
        investments: currentInvestor?.investments || [],
        dealIds: currentInvestor?.dealIds || []
      };
      
      Storage.saveInvestor(investor);
      closeModal();
      loadInvestors();
      if (currentInvestor && currentInvestor.id === investor.id) showInvestor(investor.id);
    }
    
    function editInvestor(id) {
      const investor = investors.find(i => i.id === id);
      if (!investor) return;
      
      currentInvestor = investor;
      document.getElementById('modal').classList.add('active');
      document.getElementById('modalTitle').textContent = 'Edit Investor';
      document.getElementById('investorId').value = investor.id;
      document.getElementById('firstName').value = investor.firstName;
      document.getElementById('lastName').value = investor.lastName;
      document.getElementById('email').value = investor.email;
      document.getElementById('phone').value = investor.phone || '';
      document.getElementById('entityName').value = investor.entityName || '';
      document.getElementById('address').value = investor.address || '';
      document.getElementById('accreditedStatus').value = investor.accreditedStatus || 'pending';
      document.getElementById('verificationMethod').value = investor.verificationMethod || '';
      document.getElementById('notes').value = investor.notes || '';
      document.getElementById('prefMultifamily').checked = (investor.preferences || []).includes('Multifamily');
      document.getElementById('prefRetail').checked = (investor.preferences || []).includes('Retail');
      document.getElementById('prefIndustrial').checked = (investor.preferences || []).includes('Industrial');
      document.getElementById('prefOffice').checked = (investor.preferences || []).includes('Office');
    }
    
    function editCurrent() { if (currentInvestor) editInvestor(currentInvestor.id); }
    
    function deleteInvestor() {
      if (!currentInvestor) return;
      if (!confirm(`Delete ${currentInvestor.firstName} ${currentInvestor.lastName}?`)) return;
      
      const allInvestors = Storage.getInvestors().filter(i => i.id !== currentInvestor.id);
      localStorage.setItem('syndicateInvestors', JSON.stringify(allInvestors));
      
      currentInvestor = null;
      document.getElementById('detailCard').style.display = 'none';
      document.getElementById('emptyDetail').style.display = 'block';
      loadInvestors();
    }
    
    function addInvestment() { alert('Investment tracking coming soon!'); }
    function sendDocument() { alert('Document sending coming soon!'); }
    
    document.getElementById('searchInput').addEventListener('input', renderTable);
    
    loadInvestors();
  </script>
</body>
</html>